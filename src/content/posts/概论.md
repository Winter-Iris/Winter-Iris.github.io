---
title: 操作系统概论
published: 2026-01-19
pinned: false
description: 操作系统概论
image: ""
tags:
  - 操作系统
category: 操作系统
draft: false
---


# 操作系统所处的位置

![JcAYSL7sv5o9PFI.png](https://s2.loli.net/2025/12/08/JcAYSL7sv5o9PFI.png)

- 操作系统是代码：位于:程序与硬件之间，不同的程序之间，不同的用户之间
- 操作系统(OS)的作用：在相互竞争资源的程序之间，提供对处理器、存储器、IO设备等**资源有序的控制、管理与分配。**
- 操作系统(Operating System,OS)是指**控制和管理整个计算机系统的硬件和软件资源**，并合理地组织**调度计算机的工作和资源的分配**；以**提供给用户和其他软件方便的接口和环境**；它是计算机系统中最基本的系统软件。

## 操作系统接口

- **联机命令接口**：交互式命令接口（例子：终端，用户和系统的交互）（用户说一句，系统处理一句）
- **脱机命令接口**：批处理命令接口（例子：.bat文件）（用户说一堆，系统处理一堆）
- **程序接口**：可以**在程序中进行系统调用来使用程序接口**。普通用户不能直接使用程序接口，只能通过程序代码间接使用。
- 系统调用类似于函数调用，是**应用程序请求操作系统服务**的**唯一方式**


## 对硬件机器的扩展

**没有任何软件支持的计算机成为裸机**。
在裸机上安装的操作系统可以**提供资源管理功能和方便用户的服务功能**，将裸机改造成功能更强、使用更方便的机器

# 操作系统的特征

- 并发，共享，虚拟，异步
- 没有并发和共享，就谈不上虚拟和异步，因此**并发和共享是操作系统的两个最基本的特征。**

## 并发

- **并发**：指两个或多个事件在同一时间间隔内发生。这些事件**宏观上是同时发生的，但微观上是交替发生的**。
- **并行**：指两个或多个事件在**同一时刻同时发生。**
- **操作系统的并发性**：计算机系统中“同时”运行着多个程序，**这些程序宏观上看是同时运行着的，而微观上看是交替运行的。**
- **单核CPU**同一时刻只能执行一个程序，各个程序只能**并发**地执行
- **多核CPU**同一时刻可以同时执行多个程序，多个程序可以**并行**地执行

## 共享

共享即资源共享，**是指系统中的资源可供内存中多个并发执行的进程共同使用**。

- **互斥共享**：系统中的某些资源，虽然可以提供给多个进程使用，但**一个时间段内只允许一个进程访问该资源**
- **同时共享**：系统中的某些资源，**允许一个时间段内由多个进程“同时”对它们进行访问**
- 如果失去并发性，则系统中只有一个程序正在运行，则共享性失去存在的意义
- 如果失去共享性，就无法实现同时访问文件，也就无法并发。
- **并发性和共享性相互依存**。

## 虚拟

虚拟是指**把一个物理上的实体变为若干个逻辑上的对应物**。**物理实体**（前者）是**实际存在**的，而**逻辑上对应物（后者）是用户感受到的。**

- 虚拟技术：空分复用，时分复用。
- 如果失去了并发性，一个时间段系统只运行一个程序，虚拟性就无意义了。
## 异步

异步是指，**在多道程序环境下，允许多个程序并发执行**，但由于资源有限，**进程的执行不是一贯到底的，而是走走停停，以不可预知的速度向前推进**，这就是进程的异步性。

- 只有系统拥有并发性，才会可能导致异步性。

# 操作系统的发展与分类

## 手工操作阶段

- 主要缺点：用户独占全机、人机速度矛盾导致资源利用率极低

## 单道批处理系统

![ixuo3ejJAg1wGZQ.png](https://s2.loli.net/2025/12/21/ixuo3ejJAg1wGZQ.png)

- 引入**脱机输入/输出技术**（用外围机+磁带完成），并由**监督程序**负责控制作业的输入、输出
- 主要优点：缓解了一定程度的人机速度矛盾，资源利用率有所提升。
- 主要缺点：**内存中仅能有一道程序运行**，**只有该程序运行结束之后才能调入下一道程序**。 CPU有大量的时间是在空闲等待I/O完成。**资源利用率依然很低**。

## 多道批处理系统

![duUnp9FN6tJRQo4.png](https://s2.loli.net/2025/12/21/duUnp9FN6tJRQo4.png)

- 主要优点：多道程序并发执行，共享计算机资源。资源利用率大幅提升，CPU和其他资源更能保持“忙碌”状态，**系统吞吐量增大**。
- 主要缺点：用户响应时间长，没有人机交互功能，用户提交自己的作业之后就只能等待计算机处理完成，**中间不能控制自己的作业执行**。

## 分时操作系统

- 计算机**以时间片为单位轮流为各个用户/作业服务**，各个用户可通过终端与计算机进行交互。
- 主要优点：**用户请求可以被即时响应，解决了人机交互问题**。允许多个用户同时使用一台计算机，并且用户对计算机的操作相互独立，感受不到别人的存在。
- 主要缺点：不能优先处理一些紧急任务。操作系统对各个用户/作业都是完全公平的，循环地为每个用户/作业服务一个时间片，不区分任务的紧急性。

## 实时操作系统

- 主要优点：能够优先响应一些紧急任务，某些紧急任务不需时间片排队。
- 在实时操作系统的控制下，计算机系统接收到外部信号后及时进行处理，**并且要在严格的时限内处理完事件**。
- 实时操作系统的主要特点是**及时性和可靠性**
- 硬实时系统：必须在绝对严格的规定时间内完成处理
- 软实时系统：能接受偶尔违法时间规定

# 操作系统运行机制

- 内核是操作系统最重要最核心的部分，也是最接近硬件的部分
- 在CPU设计和生产的时候就划分了特权指令和非特权指令，因此CPU执行一条指令前就能判断出其类型，**特权指令只能在内核程序中运行**。
- CPU有两种状态，“内核态”和“用户态”
	- 处于内核态时，说明此时正在运行的是内核程序，此时可以执行特权指令
	- 处于用户态时，说明此时正在运行的是应用程序，此时只能执行非特权指令
- CPU中有一个寄存器叫程序状态字寄存器(PSW),其中有个二进制位，1表“内核态”，0表示“用户态”
- 内核态→用户态：执行一条特权指令一一修改PSW的标志位为“用户态”，这个动作意味着操作系统将主动让出CPU使用权
- 用户态→内核态：由“中断”引发，硬件自动完成变态过程，触发中断信号意味着操作系统将强行夺回CPU的使用权

# 中断和异常

## 中断的作用

“中断”是让操作系统内核夺回CPU使用权的唯一途径，用户态变为内核态

## 内中断（异常）

- 与当前执行的指令有关，**中断信号来源于CPU内部**
- ### 触发源
	- **异常（Exceptions）**：
	    - 程序错误：除零、溢出、非法指令
	    - 缺页异常（Page Fault）        
	    - 断点调试
	- **陷阱（Traps）**：
	    - 系统调用（syscall）
	    - 调试陷阱
- 执行“陷入指令”，意味着**应用程序主动地将CPU控制权还给操作系统内核** ，“系统调用”就是通过陷入指令完成的

## 外中断

- 与当前执行的指令无关，中断信号来源于CPU外部
- 由处理器**外部设备**引发的中断，通常称为**硬件中断**。

## 中断的实现

- **不同的中断信号，需要用不同的中断处理程序来处理**。当CPU检测到中断信号后，会根据中断信号的类型去查询“**中断向量表**”，以此来找到相应的中断处理程序在内存中的存放位置。

# 系统调用

- “系统调用”是**操作系统提供给应用程序**（程序员/编程人员）**使用的接口**，可以理解为一种可供应用程序调用的特殊函数，**应用程序可以通过系统调用来请求获得操作系统内核的服务**
- 应用程序通过系统调用请求操作系统的服务。而系统中的各种共享资源都由操作系统内核统一掌管，因此凡是**与共享资源有关的操作**（如存储分配、I/O操作、文件管理等），**都必须通过系统调用的方式向操作系统内核提出服务请求**，由操作系统内核代为完成。这样可以保证系统的稳定性和安全性，防止用户进行非法操作。
- 系统调用的过程：
	- 传递系统调用参数
	- 执行陷入指令（用户态）
	- 执行相应的内请求核程序处理系统调用（核心态）
	- 返回应用程序
- **陷入指令是在用户态执行的**，执行陷入指令之后**立即引发一个内中断**
- 使CPU进入核心态**发出系统调用请求是在用户态**，而**对系统调用的相应处理在核心态下进行**

# 操作系统的体系结构

- 原语是一种特殊的程序，具有原子性。也就是说，这段程序的运行必须一气呵成，**不可被“中断“**
- **大内核**：**把所有操作系统功能都放在内核空间**
	- 优点：**性能高**，内核内部各种功能都可以直接相互调用
	- 缺点：内核庞大**功能复杂，难以维护** ；大内核中**某个功能模块出错，就可能导致整个系统崩溃**
- **微内核**：**内核只保留最核心功能，其他作为用户空间服务**
	- 优点：内核小功能少、**易于维护**，内核可靠性高 ；**内核外的某个功能模块出错不会导致整个系统崩溃**
	- 缺点：**性能低，需要频繁的切换用户态/核心态。** ； 用户态下的**各功能模块不可以直接相互调用**，**只能通过内核的"消息传递“来间接通信** 
- 变态的过程是有成本的，要消耗不少时间，频繁地变态会降低系统性能
- **分层结构**
	- 内核分多层，最底层是硬件，最高层是用户接口，每一层只能调用更低一层提供的接口。
	- 优点：便于调试，自底向上逐层调试即可。易扩充维护，各层之间的接口相对固定
	- 缺点：仅能调用相邻的低层，不能跨层调用。各层之间的边界难以界定。系统调用时间长（一层一层往下传递），效率低
- **模块化**
	- 把内核划分为多个模块，每个模块之间相互协作。
	- 优点：模块逻辑清晰，易于维护。支持动态加载新的内核模块（驱动程序），不需要重新编译内核。模块间之间可以直接调用，效率高。
	- 缺点：模块间相互依赖，调试较难。
- **外核**
	- 内核负责进程调度，通信等功能，外核负责为用户分配未经抽象的硬件资源，并且保证安全。
	- 优点：用户进程可以更灵活地使用硬件资源。减少了对物理内存的虚拟和映射，效率高。
	- 缺点：降低了系统的一致性，使得系统变得复杂。

# 操作系统引导

## 磁盘分区

- 一个磁盘被逻辑地分为若干区，第一个区块为主引导分区(MBR)，包含了磁盘引导程序和分区表（记录各个分区的位置，大小，地址范围）
- 安装了操作系统的分区为的活动分区。
- 活动分区的第一个扇区为活动引导记录，PBR
- **“PBR 的作用是：把控制权从 MBR 转交给“该分区里的操作系统引导程序”**

## 操作系统引导过程（BIOS/UEFI）

- CPU通电后，固定**跳转至ROM对应的地址区域**（BIOS/UEFI固件存储于此）
- BIOS：
	- CPU执行BIOS，进行硬件自检，初始化硬件。BIOS选择启动设备，把设备的第一块扇区（MBR）读入内存。
	- 执行磁盘引导程序，扫描分区表，找到 **Active（活动）分区**，读取该分区的 **PBR**，跳转到 PBR。
	- 执行PBR时，会读取操作系统启动程序Bootloader并执行，进行操作系统初始化。
- UEFI
	- 读取 EFI System Partition（ESP）
	- 启动 EFI 程序（Bootloader），选择操作系统，加载内核...
- 然后内核被加载，操作系统接管控制权。

